<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" dir="ltr" lang="ja"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>国内予選問題 |  ACM-ICPC: ACM International Collegiate Programming Contest Asia Regional Contest 2010 in Tokyo</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link type="text/css" rel="stylesheet" media="all" href="2010-j_files/reset.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/text.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/960.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/debug.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/node.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/defaults.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/system.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/system-menus.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/user.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/styles.css">
<link type="text/css" rel="stylesheet" media="all" href="2010-j_files/base.css">
    <meta name="google-site-verification" content="PIUA7eiMH6v_hh-C8pRyca6z0xjd3RT4K6cj0MZY9YQ">
</head>

<body class="not-front not-logged-in page-node node-type-page no-sidebars i18n-ja">

    <div id="contentwrapper" class="wrapper">
      <div id="content-container" class="container-16 clear-block">
    <div id="main" class="column grid-16 ">

              <h1 class="title" id="page-title">国内予選問題</h1>
                        
      <div id="main-content" class="region clear-block">
        <div id="node-37" class="node clear-block">


  <div class="content">
    <div id="problems">
<div class="column">
<h1><img src="2010-j_files/icpc_logo.png" alt="acm International Collegiate Programming Contest"></h1>
<div class="banner" align="right"><font size="-1"><br>
<i>2010/7/2 Tokyo</i></font>
</div>
<div class="column">
<h2>問題文と入力データ，出力例</h2>
<table border="1">
<tbody><tr>
<th align="center">問題文</th>
<th align="center">In/Out</th>
<th align="center">In/Out</th>
<th align="center">In/Out</th>
<th align="center">In/Out</th>
</tr>
<tr>
<td align="center"><a href="#section_A">A</a></td>
<td align="center"><a href="./qualify_judge/A1">1</a>/ <a href="./qualify_judge/A1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/A2">2</a>/ <a href="./qualify_judge/A2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/A3">3</a>/ <a href="./qualify_judge/A3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/A4">4</a>/ <a href="./qualify_judge/A4.ans">4</a></td>
</tr>
<tr>
<td align="center"><a href="#section_B">B</a></td>
<td align="center"><a href="./qualify_judge/B1">1</a>/ <a href="./qualify_judge/B1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/B2">2</a>/ <a href="./qualify_judge/B2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/B3">3</a>/ <a href="./qualify_judge/B3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/B4">4</a>/ <a href="./qualify_judge/B4.ans">4</a></td>
</tr>
<tr>
<td align="center"><a href="#section_C">C</a></td>
<td align="center"><a href="./qualify_judge/C1">1</a>/ <a href="./qualify_judge/C1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/C2">2</a>/ <a href="./qualify_judge/C2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/C3">3</a>/ <a href="./qualify_judge/C3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/C4">4</a>/ <a href="./qualify_judge/C4.ans">4</a></td>
</tr>
<tr>
<td align="center"><a href="#section_D">D</a></td>
<td align="center"><a href="./qualify_judge/D1">1</a>/ <a href="./qualify_judge/D1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/D2">2</a>/ <a href="./qualify_judge/D2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/D3">3</a>/ <a href="./qualify_judge/D3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/D4">4</a>/ <a href="./qualify_judge/D4.ans">4</a></td>
</tr>
<tr>
<td align="center"><a href="#section_E">E</a></td>
<td align="center"><a href="./qualify_judge/E1">1</a>/ <a href="./qualify_judge/E1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/E2">2</a>/ <a href="./qualify_judge/E2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/E3">3</a>/ <a href="./qualify_judge/E3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/E4">4</a>/ <a href="./qualify_judge/E4.ans">4</a></td>
</tr>
<tr>
<td align="center"><a href="#section_F">F</a></td>
<td align="center"><a href="./qualify_judge/F1">1</a>/ <a href="./qualify_judge/F1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/F2">2</a>/ <a href="./qualify_judge/F2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/F3">3</a>/ <a href="./qualify_judge/F3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/F4">4</a>/ <a href="./qualify_judge/F4.ans">4</a></td>
</tr>
<tr>
<td align="center"><a href="#section_G">G</a></td>
<td align="center"><a href="./qualify_judge/G1">1</a>/ <a href="./qualify_judge/G1.ans">1</a></td>
<td align="center"><a href="./qualify_judge/G2">2</a>/ <a href="./qualify_judge/G2.ans">2</a></td>
<td align="center"><a href="./qualify_judge/G3">3</a>/ <a href="./qualify_judge/G3.ans">3</a></td>
<td align="center"><a href="./qualify_judge/G4">4</a>/ <a href="./qualify_judge/G4.ans">4</a></td>
</tr>
</tbody></table>
<p>入力データ・出力例をzip形式でまとめたものは<a href="./qualify_judge.zip">こちら</a>からダウンロードできます．
</p></div>
<div class="column">
<h2>Links</h2>
<div><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a></div>
</div>
<div class="column problem">
<a name="section_A"><br>
<h2>Problem A</h2>
<style type="text/css">
*.math { font-style: italic; margin-right: 2pt; }
</style><h3><u>角角画伯，かく悩みき</u></h3>
<div>
<p>角角画伯はキュービズムの大家として知らない人がいるとかいないとか…角角画伯の今年の主題は，正方形だそうです．今日は角角画伯のアトリエにお邪魔しています．
</p>
<p>アトリエの中央には途方もなく大きなテーブルがあります．その傍らには同じ大きさに切り揃えられた正方形がたくさん用意されています．角角画伯は一
枚の正方形をテーブルの中央に置きました．それに続いて，他の正方形を順番に並べます．その様子を観察すると，画伯の几帳面な性格を反映しているのでしょ
うか，どの正方形を置くときも，必ず別の正方形に隣接して置き，隣接した正方形の辺をぴたりと揃えているようです．
</p>
<p>さあ最初の作品が完成したようです．画伯はごきげんのようです．どうです，この満足そうなお顔は．</p>
<p>あれ？おやおや，今度は画伯は頭を抱えてしまいました．どうしたことでしょう．ははあ．この作品を入れるのにぴったりの箱を注文したいのだけれどもその長さを測るのが大変だと嘆いておられます．さあ，みんなで画伯を手伝ってあげましょう．</p>
<p>画伯が完成させた作品のデータが与えられますので，その幅と高さを出力するプログラムを書いて下さい．正方形の一辺の長さは1とします．画伯が同じ位置に複数の正方形を積み重ねないことを仮定して構いません．</p>
<p>あれあれ，下の図を眺めながら「その十字架はもっと小さい箱に入るんじゃない」なんて言ってる人がいますね．角角画伯は悲しそうな顔で首を振りながら「斜めに入れるような人は自分の画風を理解していない」と言っていますよ．</p>
<p style="text-align: center">
<img src="2010-j_files/A-1.png">
</p>
</div>
<h3>Input</h3>
<div>
<p>入力は複数のデータセットからなる．各データセットは，作品の制作手順を表したデータであり，その形式は次の通りである．</p>
<blockquote><p>
<span class="math">N</span><br>
<span class="math">n</span><sub>1</sub> <span class="math">d</span><sub>1</sub><br>
<span class="math">n</span><sub>2</sub> <span class="math">d</span><sub>2</sub><br>
...<br>
<span class="math">n<sub>N</sub></span><sub>-1</sub> <span class="math">d<sub>N</sub></span><sub>-1</sub>
</p></blockquote>
<p>データセットの最初の行には作品を構成する正方形の数(= <span class="math">N</span>)が与えられる．<span class="math">N</span>は1以上，200未満の整数である．</p>
<p>データセットの残りの(<span class="math">N</span>-1)行は正方形の置き方を表している．“<span class="math">n<sub>i</sub> d<sub>i</sub></span>”は，<span class="math">i</span> (≤ <span class="math">N</span>-1)番の正方形の置き方を指示している．ここで，正方形の番号は，テーブルの上に一番最初に置かれたものを0とし，その後，置いた順番に1, 2, …, (<span class="math">N</span>-1)と番号づけられるものとする．なお0番の正方形に対する置き方の指示はない．</p>
<p><span class="math">i</span>番の正方形に対する置き方の指示 “<span class="math">n<sub>i</sub> d<sub>i</sub></span>” は，<span class="math">i</span>番の正方形を<span class="math">n<sub>i</sub></span>番の正方形に対して<span class="math">d<sub>i</sub></span>で示される方角に隣接して置くことを指示する．ここで，<span class="math">d<sub>i</sub></span>は0, 1, 2, 3のいずれかをとり，それぞれ左側(= 0)，下側 (= 1)，右側 (= 2)，上側 (= 3)を表す．</p>
<p>例えば以下は<b>Sample Input</b>の四つのデータセットに対応した作品を図示したものである．図中の番号は，正方形の番号に相当する．</p>
<p style="text-align: center">
<img src="2010-j_files/A-2.png">
</p>
<p>入力の終わりはひとつのゼロのみからなる行で表される．</p>
</div>
<h3>Output</h3>
<div>
<p>各データセットについて，作品の幅と高さを整数として，それぞれ1行に出力しなさい．幅と高さの間は1文字の空白で区切り，各出力行はこれら以外の文字を含んではならない．</p>
</div>
<h3>Sample Input</h3>
<div>
<pre>1
5
0 0
0 1
0 2
0 3
12
0 0
1 0
2 0
3 1
4 1
5 1
6 2
7 2
8 2
9 3
10 3
10
0 2
1 2
2 2
3 2
2 1
5 1
6 1
7 1
8 1
0
</pre>
</div>
<h3>Output for the Sample Input</h3>
<div>
<pre>1 1
3 3
4 4
5 6
</pre></div>
</a><div align="right"><a name="section_A">(End of Problem A) </a><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
<div class="column problem">
<a name="section_B"><br>
<h2>Problem B</h2>
<h3><u>迷図と命ず</u></h3>
<div>
<p>
日本語では「迷路」と呼ぶことが多い maze だが，英語と発音を似せて「迷図」と呼ぶ人もいる．迷図を通り抜けられないようでは，国内予選を通過するのも難しいかも!
</p>
<p>
この問題の迷図は，四角を縦横に並べた長方形の領域である．この領域は出入口を除いて壁で囲まれている．迷図の入口は長方形の上辺の最も左側で，つまり最上段の最左の四角の上辺は開いている．出口は同様に下辺の最も右側にある．
</p>
<p>
迷図の中では縦または横に隣り合う四角に行くことができる．しかし隣とは壁で隔てられていることがあり，その場合直接には行き来できない．
</p>
<p>
あなたの仕事は，入口から出口までの最短経路の長さを求めることである．最短経路が複数あることもあれば，ひとつもないこともあるのに注意されたい．
</p>
</div>
<h3>Input</h3>
<div>
<p>
入力はそれぞれが迷図を表すひとつ以上のデータセットからなる．
</p>
<p>
データセットの最初の行には迷図の幅 <i>w</i> と高さ <i>h</i> を与えるふたつの整数値がこの順に入っている．
</p>
<p>
それに続く 2 × <i>h</i> − 1 行は，隣接する四角の間の壁の有無を示している．最初の行の先頭は空白で，その後には <i>w</i> −1 個の 1 または 0 が空白ひとつで区切られて並んでいる．これらは一番上の行の横に隣り合う四角の間の壁の有無を示すものである．1 は壁があることを，0 はないことを意味する．  次の行の先頭には空白はなく，<i>w</i> 個の 1または 0 が空白ひとつを区切りに続く．これらは最初と次の行の縦に隣り合う四角の間の壁の有無を表す．整数 1/0 は壁の有/無を示す．引き続く行は交互に横と縦に隣り合う四角の間の壁の有無を同様に表す．
</p>
<p>
入力の終わりは二つのゼロを含む行で表される．
</p>
<p>
データセット数は100以下である．長方形領域の高さも幅も2以上30以下である．
</p>

</div>
<h3>Output</h3>
<div>
<p>
各データセットについて，入口から出口までの最短経路長を表す整数ひとつを持つ行を出力せよ．ここでは経路の長さは通過する四角の数で表す．迷図を通り抜ける経路がない場合には，ゼロひとつを含む行を出力せよ．出力行にはこの数値以外の文字を含んではならない．
</p>
</div>
<h3>Sample Input</h3>
<div>
<img src="2010-j_files/B-1.png" align="right" width="60%">
<pre>2 3
 1
0 1
 0
1 0
 1
9 4
 1 0 1 0 0 0 0 0
0 1 1 0 1 1 0 0 0
 1 0 1 1 0 0 0 0
0 0 0 0 0 0 0 1 1
 0 0 0 1 0 0 1 1
0 0 0 0 1 1 0 0 0
 0 0 0 0 0 0 1 0
12 5
 1 0 0 0 0 0 0 0 0 0 0
0 0 0 1 1 0 0 0 0 0 0 0
 1 0 1 0 0 0 0 0 0 0 0
0 0 0 0 0 0 1 1 0 0 0 0
 0 0 1 0 0 1 0 1 0 0 0
0 0 0 1 1 0 1 1 0 1 1 0
 0 0 0 0 0 1 0 0 1 0 0
0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 1 0 0
0 0
</pre><p><br clear="all">
</p></div>
<h3>Output for the Sample Input</h3>
<div>
<pre>4
0
20
</pre></div>
</a><div align="right"><a name="section_B">(End of Problem B) </a><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
<div class="column problem">
<a name="section_C"><br>
<h2>Problem C</h2>
<h3><u>ポロック予想</u></h3>
</a><div><a name="section_C">
<p>
<i>n</i> 番目の正三角形数は，最初の <i>n</i> 個の正整数の和と定義される．<br>
<i>n</i> 番目の正四面体数は，最初の <i>n</i> 個の正三角形数の和と定義される．<br>
簡単に示せるように，<i>n</i> 番目の正四面体数は <i>n</i>(<i>n</i>+1)(<i>n</i>+2) ⁄ 6 に等しい．<br>
たとえば，5番目の正四面体数は 1+(1+2)+(1+2+3)+(1+2+3+4)+(1+2+3+4+5)<br>
= 5×6×7 ⁄ 6<br>
= 35 である．
</p>
</a><dl><a name="section_C">
<dt>
<p>最初の5個の正三角形数</p>
<p>1, 3, 6, 10, 15<br>
</p></dt>
</a><dd><a name="section_C">
</a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-11-large.png"><img src="2010-j_files/C-11.png" alt="Tr[1]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-12-large.png"><img src="2010-j_files/C-12.png" alt="Tr[2]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-13-large.png"><img src="2010-j_files/C-13.png" alt="Tr[3]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-14-large.png"><img src="2010-j_files/C-14.png" alt="Tr[4]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-15-large.png"><img src="2010-j_files/C-15.png" alt="Tr[5]" align="top"></a><br>
</dd>
<dt>
<p>最初の5個の正四面体数</p>
<p>1, 4, 10, 20, 35<br>
</p></dt>
<dd>
<a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-1-large.png"><img src="2010-j_files/C-1.png" alt="Tet[1]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-2-large.png"><img src="2010-j_files/C-2.png" alt="Tet[2]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-3-large.png"><img src="2010-j_files/C-3.png" alt="Tet[3]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-4-large.png"><img src="2010-j_files/C-4.png" alt="Tet[4]" align="top"></a><a href="http://icpc2010.honiden.nii.ac.jp/domestic-contest/C-5-large.png"><img src="2010-j_files/C-5.png" alt="Tet[5]" align="top"></a><br>
</dd>
</dl>
<p>
1850年，職業数学者ではなく英国の法律家でありトーリー党（現在の保守党）の政治家でもあった初代准男爵フレデリック・ポロック卿が，すべての正整数は5個以内の正四面体数の和として表現できると予想した．<br>
ただし，和の中で同じ正四面体数が複数回出現してよく，その場合，それぞれの出現を別々に数えるものとする．<br>
この予想は一世紀半以上も未解決なままである．
</p>
<p>
あなたの任務は，<br>
個別の整数に対してポロック予想が成り立つことを確認するプログラムを書くことである．<br>
あなたのプログラムは，<br>
入力された整数おのおのについて，<br>
それを正四面体数の和として表すための正四面体数の個数の最小値を計算しなくてはならない．<br>
なぜか，ついでに，<br>
奇数の正四面体数だけ使える場合の同様の計算もしなくてはならない．
</p>
<p>
たとえば，<br>
40は2個の正四面体数の和<br>
4×5×6 ⁄ 6 + 4×5×6 ⁄ 6<br>
として表すことができるが，<br>
40自体は正四面体数ではない．<br>
40は6個の奇数の正四面体数の和<br>
5×6×7 ⁄ 6 + 1×2×3 ⁄ 6 + 1×2×3 ⁄ 6 + 1×2×3 ⁄ 6 + 1×2×3 ⁄ 6 + 1×2×3 ⁄ 6<br>
として表すことができるが，<br>
より少ない個数の奇数の正四面体数の和として表すことはできない．<br>
したがって，あなたのプログラムに40が与えられると，<br>
2と6と答えなくてはならない．
</p>
</div>
<h3>Input</h3>
<div>
<p>
入力は行の並びで，<br>
おのおのの行には 10<sup>6</sup> より小さい正整数がちょうど一つだけ含まれている．<br>
入力の終わりは，一文字の <t>0</t> だけを含む行で示される．
</p>
</div>
<h3>Output</h3>
<div>
<p>
入力された正整数おのおのについて，<br>
二つの整数を空白で区切った行を出力せよ．<br>
一つめの整数は，<br>
入力された整数を正四面体数の和として表すために必要な正四面体数の個数の最小値である．<br>
二つめの整数は，<br>
入力された整数を奇数の正四面体数の和として表すために必要な奇数の正四面体数の個数の最小値である．<br>
出力に余分な文字が含まれてはならない．
</p>
</div>
<h3>Sample Input</h3>
<div>
<pre>40
14
5
165
120
103
106
139
0
</pre></div>
<h3>Output for the Sample Input</h3>
<div>
<pre>2 6
2 14
2 5
1 1
1 18
5 35
4 4
3 37
</pre></div>
<div align="right">(End of Problem C) <a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
<div class="column problem">
<a name="section_D"><br>
<h2>Problem D</h2>
<h3><u>ぐらぐら</u></h3>
<div>
<p>あなたの勤め先のピカソニアン・キュービズム国際センター(ICPC)の事務局では，若き芸術家のための美術館を新たに建設する．そのためセンターでは建物の設計コンペを開催することになった．
</p>
<p>コンペに提出される図面は，下に示すように，かの有名なゲームの画面のようなものになる．</p>
<p style="text-align: center">
<img src="2010-j_files/D-1.png">
</p>
<p>
それというのも，センターが指定する工法が「ピース」と呼ばれる規格化されたユニットを積み重ねて建築するというものだからである．各ピースは4つの立方体のブロックをつなげて作られている．センターはさらに，応募される設計に次のような条件を課している．
</p>
<ul>
<li>ピースはブロック単位で位置を揃えてある．つまりピースとピースが接する場合，両者のブロックの面どうしはぴったり重なるような置き方しか許されない．
</li><li>ピースは安定していなければいけない．ピースは積み重ねられるだけなので，崩れてしまわないように重心の位置を慎重に定めなければいけない．
</li><li>ピースは樹状に積み重ねられ，それによって若き芸術家達の無限の可能性を象徴する．つまり，地面に接しているピースは唯1つだけで，それ以外の各ピースの下面が接しているピースは丁度1つだけに限られている．
</li><li>建物は平らな形に限られる．これは建設予定地が下図に示すようなお堀と高速道路にはさまれた狭い所で，お堀と高速道路の間にはブロック1個分の幅しかないためである．
</li></ul>
<p style="text-align: center">
<img src="2010-j_files/D-2.png">
</p>
<p>建物の安定性を完全に調べるには，複雑な構造計算が必要なため何日もかかる．そこであなたは安定性の簡易診断を行うことを命じられた．簡易診断の方法は次のようである．
</p>
<p>以下では各ブロックの重心はブロックの中心にあり，全てのブロックは同じ重さだと仮定する．また，ブロックの位置をブロックの左下の<i>xy</i>座標によって表す．単位はブロックの辺の長さである．
</p>
<p>
ピースを構成するブロックで下面が他のピースまたは地面に接しているもののうち，一番左のものの左端の<i>x</i>座標を <i>x<sub>L</sub></i>，一番右のものの右端の<i>x</i>座標を <i>x<sub>R</sub></i> とする．また，このピースによって直接または間接に支えられているすべてのピースとこのピース自身をあわせた全体の重心の<i>x</i>座標を<i>M</i>とする．このとき<i>x<sub>L</sub> &lt; M &lt; x<sub>R</sub></i> が成り立てばピースは安定であり，そうでなければ不安定である．建物を構成するピースが1つでも不安定であれば，その建物は不安定である．
</p>
<p>
上記の診断方法は，実際には崩れないような設計を不安定と判定する場合もあることに注意せよ．例えば，下図左の設計は不安定と判定される．
</p>
<table>
<tbody><tr>
<td><img src="2010-j_files/D-3.png"></td>
<td></td>
<td><img src="2010-j_files/D-4.png"></td>
</tr>
</tbody></table>
<p>
またこの診断方法は境界状態にある場合は不安定と判定することにも注意せよ．例えば，上図右の設計における上のピースの重心は，下のピースの右端の真上にあるが，これは不安定と判定される．
</p>
<p>
簡易診断方法によって各設計の安定性を診断するプログラムを書け．
</p>
</div>
<h3>Input</h3>
<div>
<p>
入力は複数のデータセットからなる．入力の終わりは空白1つで区切られた2個のゼロからなる行によって与えられる．各データセットは建物の正面図を表し，その形式は以下の通りである．
</p>
<blockquote><p><i>w h</i>			<br><br>
<i>p</i><sub>0(<i>h</i>-1)</sub><i>p</i><sub>1(<i>h</i>-1)</sub>...<i>p</i><sub>(<i>w</i>-1)(<i>h</i>-1)</sub>	<br><br>
...		 	     <br><br>
<i>p</i><sub>01</sub><i>p</i><sub>11</sub>...<i>p</i><sub>(<i>w</i>-1)1</sub>	<br><br>
<i>p</i><sub>00</sub><i>p</i><sub>10</sub>...<i>p</i><sub>(<i>w</i>-1)0</sub>	<br>
</p></blockquote>
<p>
空白で区切られた整数<i>w</i>および<i>h</i>はそれぞれ配置の列数と行数を表す．ここで 1 ≤ <i>w</i> ≤<br>
10 かつ 1 ≤ <i>h</i> ≤ 60 と仮定してよい．続く<i>h</i>行はピースの配置を与える．<i>p<sub>xy</sub></i>の文字は座標(<i>x</i>,<i>y</i>)のブロックの状態を表し，何もないことを表す「<code>.</code>」あるいはピースを構成するブロックを表す「<code>1</code>」から「<code>9</code>」までの数字のどれかである．(すでに述べたように，ブロックの位置はブロックの左下の<i>xy</i>座標によって表す．)
</p>
<p>
同じ数字を持つ2つのブロックが上下あるいは左右を接している場合，それらのブロックは同一のピースの部分である．(同じ数字を持つ異なる2つのピースが有り得ることに注意せよ．)座標(<i>x</i>,0)にあるブロックの下面は地面に接している．
</p>
<p>
各データセットは，ピースを樹状に積み重ねているものと仮定してよい．
</p>
</div>
<h3>Output</h3>
<div>
<p>
それぞれのデータセットについて，設計が上記の条件に従って安定な場合には<code>STABLE</code>, そうでない場合は<code>UNSTABLE</code>と全て大文字で書かれた行を出力せよ．出力にそれ以外の文字を含めてはならない．</p>
</div>
<h3>Sample Input</h3>
<div>
<pre>4 5
..33
..33
2222
..1.
.111
5 7
....1
.1..1
.1..1
11..1
.2222
..111
...1.
3 6
.3.
233
23.
22.
.11
.11
4 3
2222
..11
..11
4 5
.3..
33..
322.
2211
.11.
3 3
222
2.1
111
3 4
11.
11.
.2.
222
3 4
.11
.11
.2.
222
2 7
11
.1
21
22
23
.3
33
2 3
1.
11
.1
0 0
</pre></div>
<h3>Output for the Sample Input</h3>
<div>
<pre>STABLE
STABLE
STABLE
UNSTABLE
STABLE
STABLE
UNSTABLE
UNSTABLE
UNSTABLE
UNSTABLE
</pre></div>
</a><div align="right"><a name="section_D">(End of Problem D) </a><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
<div class="column problem">
<a name="section_E"><br>
<h2>Problem E</h2>
<h3><u>最強の呪文</u></h3>
<div>
<p>
昔々，多くの「魔法の紋様」を発明した魔法使いがいた．<br>
彼の発明した魔法の紋様が床に描かれた部屋では，<br>
呪文を唱えることで，誰でも魔法が使えるようになるのだ！<br>
ただし，使える呪文は紋様によってまちまちである．<br>
あなたの仕事は，指定された魔法の紋様に対し，<br>
それによって使用可能となる呪文のうち，最強のものを突き止めることだ．
</p>
<p>
呪文は，英小文字の文字列であり，<br>
特に辞書順で早ければ早い呪文であるほど，強い呪文である．<br>
ここで文字列 w が文字列 u より辞書順で早いとは，<br>
w と u とで異なる最初の文字が a&lt;b&lt;...&lt;z の順序で小さいか，<br>
または w が u の接頭辞であることを言う．<br>
例として，"abcd" は "abe" より早く（文字 c は e より小さいため），<br>
また，"abe" は "abef" より早い（接頭辞になっているため）．
</p>
<p>
魔法の紋様は，番号のついた <em>節点</em> と，それらを結ぶ<em>矢印</em><br>
からなる図形である．<br>
矢印には <em>ラベル</em> と呼ばれる小文字の文字列がついている．<br>
また，<em>スター</em> と<em>ゴールド</em> と呼ばれる，<br>
二つの特別な節点がある．<br>
魔法の紋様によって使えるようになる呪文とはすなわち，<br>
その紋様のスターからゴールドへと矢印をたどって得られるラベルを順に結合して得られる文字列である．
</p>
<p>
次に，四つの節点と7本の矢印からなる例を図示する．
</p>
<p></p><center><br>
<img src="2010-j_files/E-4.png" alt="picture: sample dataset 1" height="283" width="312"><br>
</center><p></p>
<p>
0 がスター，2 がゴールドである．<br>
この魔法の紋様によって，例えば
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
 0 --"abra"--&gt; 1 --"cada"--&gt; 3 --"bra"--&gt; 2
</p>
<p>
という経路から得られる呪文 "abracadabra" が使えるようになる．他には，
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
 0 --"oil"--&gt; 1 --"cada"--&gt; 3 --"bra"--&gt; 2 --"ket"--&gt; 3 --"da"--&gt; 3 --"da"--&gt; 3 --"bra"--&gt; 2
</p>
<p>
から得られる "oilcadabraketdadabra" などもある．<br>
"abracadabra" と "oilcadabraketdadabra" では前者の方が辞書順で早いので，より強い呪文である．<br>
実は，この魔法の紋様で使用可能となる呪文で "abracadabra" 以上に強いものは存在しない．<br>
従ってこの場合，あなたが求めるべき答えは "abracadabra" となる．
</p>
<p>
もしも，最強の呪文が定められないときには，"NO" と答えて欲しい．<br>
これには二つの場合がある．一つは，スターからゴールドへ到達できない場合である．<br>
もう一つは，どんな呪文をとっても，<br>
それよりさらに強い呪文が存在するような場合である．<br>
たとえば次の図のような魔法の紋様では，<br>
"b" よりも "ab" が強く，<br>
"ab" よりも "aab" が強いといったように，<br>
どの呪文をとってもさらに一つ a を増やすと，辞書順で早い，より強い呪文となる．
</p>
<p></p><center><br>
<img src="2010-j_files/E-2.png" alt="picture: sample dataset 2" height="123" width="242"><br>
</center>
<p></p></div>
<h3>Input</h3>
<div>
<p>
入力は最大で150個のデータセットからなる．<br>
各データセットの形式は次のとおりである．
</p>
<blockquote><p>
<i>n a s g</i><br><br>
<i>x</i><sub>1</sub> <i>y</i><sub>1</sub> <i>lab</i><sub>1</sub><br><br>
<i>x</i><sub>2</sub> <i>y</i><sub>2</sub> <i>lab</i><sub>2</sub><br><br>
...<br><br>
<i>x<sub>a</sub> <i>y</i><sub>a</sub> <i>lab</i><sub>a</sub></i><br></p>
</blockquote>
<p>
データセットの最初の行は4個の整数を含む．<i>n</i> は節点の数，<i>a</i> は矢印の数を表す．<br>
<i>s</i> と <i>g</i> はそれぞれスターとゴールドの番号を示す．<br>
続く <i>a</i> 行はそれぞれ2個の整数と1個の文字列からなり，矢印の情報を表す．<br>
<i>x<sub>i</sub></i> <i>y<sub>i</sub></i> <i>lab<sub>i</sub></i> という行は，<br>
節点 <i>x<sub>i</sub></i> から出て節点 <i>y<sub>i</sub></i> を指す，<br>
ラベルが <i>lab<sub>i</sub></i> の矢印を表している．<br>
データセット中の値は次の条件を満たす：<br>
2 ≤ <i>n</i> ≤ 40,<br>
0 ≤ <i>a</i> ≤ 400,<br>
0 ≤ <i>s</i>, <i>g</i>, <i>x<sub>i</sub></i>&nbsp;, <i>y<sub>i</sub></i> &lt; <i>n</i>.<br>
<i>s</i> ≠<i>g</i>,<br>
<i>lab<sub>i</sub></i> は長さ1以上6以下の，英小文字のみからなる文字列である．<br>
矢印の両端が同一節点の場合 (<i>x<sub>i</sub></i> = <i>y<sub>i</sub></i> ) や，<br>
節点の対を複数の矢印が結ぶ場合<br>
(異なる <i>i, j</i> に対し<br>
<i>x<sub>i</sub></i> = <i>x<sub>j</sub></i> かつ <i>y<sub>i</sub></i> = <i>y<sub>j</sub></i> )<br>
もあり得ることに注意して欲しい．
</p>
<p>
入力の終わりは4個のゼロからなる行によって与えられる．
</p>
</div>
<h3>Output</h3>
<div>
<p>
各データセットについて，最も強い呪文が存在すれば，それぞれ1行に出力しなさい．<br>
存在しない場合は NO を1行に出力しなさい．<br>
各出力行はこれ以外の文字を含んではならない．
</p>
</div>
<h3>Sample Input</h3>
<div>
<pre>4 7 0 2
0 1 abra
0 1 oil
2 0 ket
1 3 cada
3 3 da
3 2 bra
2 3 ket
2 2 0 1
0 0 a
0 1 b
5 6 3 0
3 1 op
3 2 op
3 4 opq
1 0 st
2 0 qr
4 0 r
2 1 0 1
1 1 loooop
0 0 0 0
</pre></div>
<h3>Output for the Sample Input</h3>
<div>
<pre>abracadabra
NO
opqr
NO
</pre></div>
</a><div align="right"><a name="section_E">(End of Problem E) </a><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
<div class="column problem">
<a name="section_F"><br>
<h2>Problem F</h2>
<h3><u>古い記憶</u></h3>
<div>
<p>
西暦4272年，プログラミング文学の巨匠，アイザック・コーネル・パンサーキャロル博士は<br>
三度の世界コンピューターウイルス大戦を奇跡的に生き残り，<br>
今年で丁度90歳になったところでノーベル文学賞を受賞した．<br>
メディアは彼の一生を細大漏らさず報道したが，一つだけ報道できなかったことがあった――それは彼がまだ小学生の頃に書いた作文だった．<br>
彼は作文を保管しておいたので，それを報道陣に見せることを快諾したのだが，<br>
最大の問題は，第三次世界コンピューターウイルス大戦の際に保管していた媒体が<br>
コンピューターウイルスに何回か感染していたので，文章が改ざんされているかもしれない点だ．
</p>
<p>
更に調査を進めたところ，保管していた作文はやはり改ざんされていることが分かった．なぜ分かったのか？<br>
80年以上前に，彼のクラスメートは感染する前に元の作文を脳に転送していたのだ．<br>
半導体脳の発明により，人は脳に転送した文章を何世紀にもわたって完全に保持することができる．<br>
容量が限られているため，文章全体を覚えている人はいなかったが，<br>
我々はなんとかして文章の一部をクラスメートの一人の脳から引き出した．悲しいことに，それは手元に保管していた作文と完全には一致していなかった．<br>
これはウイルス感染が無ければありえないことだ．
</p>
<p>
現在，そのコンピューターウイルスについて分かっていることは，ウイルスが作文に感染するたびに以下のうちどれか一つを行うことである．</p>
<ol>
<li>ウイルスはランダムな文字を文章中のランダムな位置に挿入する．（例："ABCD" → "ABCZD"）</li>
<li>ウイルスは文章中の文字を1文字ランダムに選び，その文字を別の文字に変換する．（例："ABCD" → "ABXD"）</li>
<li>ウイルスは文章中の文字を1文字ランダムに選び，その文字を文章中から取り除く．（例："ABCD" → "ACD"）</li>
</ol>
<p>また，侵入ログの量から推定することでウイルス感染が起こりえた回数の最大値も貴方は知っている．<br>
幸運なことに，彼のクラスメートのほとんどは彼の作文の少なくとも一部（以降<i>ピース</i>と呼ぶ）を覚えていてくれたようなのだ．<br>
全ての証拠を総合すれば，元の作文を復元できるかもしれない．<br>
貴方はジャーナリスト兼コンピュータ科学者として，元の作文に書かれていた文章としてどのようなものがあり得るのか，与えられた<i>ピース</i>や改ざんされてしまった手元の文章を元に計算するコンピュータープログラムを書きたい．
</p>
</div>
<h3>Input</h3>
<div>
<p>
入力は複数のデータセットからなる．データセット数は100以下である．<br>
データセットは以下の形式をしている．
</p>
<blockquote><p>
<i>d n</i><br><br>
<i>改ざん文章</i><br><br>
<i>ピース<sub>1</sub></i><br><br>
<i>ピース<sub>2</sub></i><br><br>
<i>...</i><br><br>
<i>ピース<sub>n</sub></i><br>
</p></blockquote>
<p>
データセットの1行目は二つの正の整数 <i>d</i> (<i>d</i> ≤ 2) と <i>n</i> (<i>n</i> ≤ 30) からなり，<br>
<i>d</i>は作文にウイルスが感染した回数の最大値を，<i>n</i>はピースの数を表している．
</p>
<p>
データセットの2行目は，手元にある改ざんされた文章である．以降これを「<i>改ざん文章</i>」と呼ぶ．<br>
改ざん文章の長さは40文字以下である．
</p>
<p>
データセット中の残りの行は<i>ピース</i>と呼ばれ，彼のクラスメートが覚えていた元の作文の一部である．<br>
各々のピースは20文字以下で，最低13文字ある．ピースは全て同じ長さである．<br>
改ざん文章やピースに現れる文字は，英語アルファベット大文字（`A'から`Z'）とピリオド（`.'）である．<br>
彼が用いていた言語は分かち書きをしないので，ピースや改ざん文章中に空白文字は現れない．
</p>
<p>
二つのゼロのみを含む行が入力の終わりを表す．
</p>
<p>
クラスメートは充分にたくさんいたので，元の作文中にあるどの文字も必ず最低一つのピースでカバーされていると仮定してよい．<br>
一つのピースが元の作文を2回以上カバーすることがある．元の作文には繰り返しがあるかもしれない．<br>
また，彼のクラスメートは勘違いをして関係ないピースを提出したかもしれないので，幾つかのピースは元の作文中に現れないかもしれないことに注意せよ．
</p>
</div>
<h3>Output</h3>
<div>
<p>
各データセットに対して何を出力すれば良いかを以下に説明する．<br>
与えられたピースや改ざん文書と合う元の作文が <i>c</i> 種類有り得るとする．<br>
最初に <i>c</i> を含む1行を出力せよ．<br>
もし<i>c</i>が5以下の場合には，さらに辞書順で1行に一つずつそれらの可能性を表示せよ．<br>
辞書順では '.' が他のどの文字よりも早いことに注意せよ．<br>
<i>c</i>は0でないことを仮定して良い．<br>
上記で指示されていないいかなる文字も出力してはならない．
</p>
</div>
<h3>Sample Input</h3>
<div>
<pre>1 4
AABBCCDDEEFFGGHHIJJKKLLMMNNOOPP
AABBCCDDEEFFGG
CCDDEEFFGGHHII
FFGGHHIIJJKKLL
JJKKLLMMNNOOPP
2 3
ABRACADABRA.ABBRACADABRA.
ABRACADABRA.A
.ABRACADABRA.
BRA.ABRACADAB
2 2
AAAAAAAAAAAAAAAA
AAAAAAAAAAAAA
AAAAAAAAAAAAA
2 3
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXAXXXXXX
XXXXXXBXXXXXX
XXXXXXXXXXXXX
0 0
</pre></div>
<h3>Output for the Sample Input</h3>
<div>
<pre>1
AABBCCDDEEFFGGHHIIJJKKLLMMNNOOPP
5
.ABRACADABRA.ABRACADABRA.
ABRACADABRA.A.ABRACADABRA.
ABRACADABRA.AABRACADABRA.A
ABRACADABRA.ABRACADABRA.
ABRACADABRA.ABRACADABRA.A
5
AAAAAAAAAAAAAA
AAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAA
257
</pre></div>
</a><div align="right"><a name="section_F">(End of Problem F) </a><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
<div class="column problem">
<a name="section_G"><br>
<h2>Problem G</h2>
<h3><u>レーザー光の反射</u></h3>
<div>
<p>
レーザー光発生装置が，目標物やいくつかの鏡とともに，水平面上に設置されている．<br>
鏡は平面上で直立しており，その両面ともに平面であり，レーザー光を反射することができる．<br>
異なる反射を使うことにより，レーザー光を目標物に向ける方向は複数ありうる．<br>
あなたの仕事は，装置から目標物に至るレーザー光の最短経路を求め，その長さを答えることである．
</p>
<p>
図 G-1 は，複数の経路の例を示したものであり，<br>
太線は最短経路を表している．
</p>
<p></p><center><br>
<img src="2010-j_files/G-0.png" align="middle"><br><br></center><p></p>
<p>図 G-1: 可能な経路の例</p>
<p>
</p></div>
<h3>Input</h3>
<div>
<p>
入力は複数のデータセットからなり，入力の終わりは，ゼロを一つだけ含む行で表される．
</p>
<p>
各データセットの形式は次のとおりである．<br>
データセット中の <i>n</i> 以外の値は，すべて 0 以上 100 以下の整数である．
</p>

<blockquote><p>
<i>n</i><br><br>
<i>PX</i><sub>1</sub> <i>PY</i><sub>1</sub> <i>QX</i><sub>1</sub> <i>QY</i><sub>1</sub><br><br>
...<br><br>
<i>PX<sub><i>n</i></sub></i> <i>PY<sub><i>n</i></sub></i> <i>QX<sub><i>n</i></sub></i> <i>QY<sub><i>n</i></sub></i><br><br>
<i>TX</i> <i>TY</i><br><br>
<i>LX</i> <i>LY</i><br>
</p></blockquote>
<p>
データセットの最初の行は，鏡の枚数を表す整数 <i>n</i> (1 ≤ <i>n</i> ≤ 5) である．<br>
引き続く <i>n</i> 行は，それぞれの鏡の水平面上の位置を示し，<br>
座標 (<i>PX<sub>i</sub></i>, <i>PY<sub>i</sub></i>) と<br>
 (<i>QX<sub>i</sub></i>, <i>QY<sub>i</sub></i>) が，<br>
鏡の両端の位置を表している．<br>
鏡同士は，互いに離れて位置している．<br>
最後の 2 行は，目標物の位置 (<i>TX</i>, <i>TY</i>) と，<br>
レーザー光発生装置の位置 (<i>LX</i>, <i>LY</i>) を示している．<br>
目標物とレーザー光発生装置の位置は互いに異なり，<br>
また，両者とも鏡から離れている．
</p>
<p>
レーザー光発生装置及び目標物の大きさは 0 と仮定してよいほど小さい．<br>
鏡の厚みについても無視してよい．
</p>
<p>
また，与えられたデータセットについて，以下のような仮定をしてよい．</p>
<ul>
<li>レーザー光発生装置から目標物に至る経路は，少なくとも一つ存在する．</li>
<li>最短経路における反射回数は 6 回未満である．</li>
<li>
最短経路は，どちらかの端から 0.001 単位距離以内の点で<br>
鏡面を含む平面と交差もしくは接することはない．
</li>
<li>
仮に，ビーム光が鏡面を含む平面にどちらかの端から<br>
 0.001 単位距離以内の点で到達した際に，<br>
反射するか通過するかを任意に選択できたとしても，<br>
レーザー光発生装置から目標物への経路が，最短経路より短くなることはない．
</li>
<li>
装置から任意の方向に照射されたレーザー光は，<br>
6 回目の反射点に到達する (6 回目の反射は含まない)までは，<br>
鏡で反射する際，<br>
もしくは鏡から 0.001 単位距離の範囲を通過する際に，<br>
鏡と光の経路がなす角 <i>θ</i> について，sin(<i>θ</i>)  &gt; 0.1 を満たす．
</li>
</ul>

<p>
図 G-1 は，後に示す Sample Input 中の最初のデータセットに対応する．<br>
図 G-2 は，Sample Input の引き続くデータセットに対する最短経路を示したものである．
</p>
<p></p><center><br>
<img src="2010-j_files/G-2.png" align="middle"><br><br></center><p></p>
<p>図 G-2: 最短経路の例</p>
<p>
</p></div>
<h3>Output</h3>
<div>
<p>
各データセットに対して，レーザー光発生装置から目標物に至るレーザー光の最短経路<br>
の長さを，一行に出力せよ．<br>
答えには 0.001 を越える誤差があってはいけない．<br>
それ以外の余計な文字を出力してはならない．
</p>
</div>
<h3>Sample Input</h3>
<div>
<pre>2
30 10 30 75
60 30 60 95
90 0
0 100
1
20 81 90 90
10 90
90 10
2
10 0 10 58
20 20 20 58
0 70
30 0
4
8 0 8 60
16 16 16 48
16 10 28 30
16 52 28 34
24 0
24 64
5
8 0 8 60
16 16 16 48
16 10 28 30
16 52 28 34
100 0 100 50
24 0
24 64
0
</pre></div>
<h3>Output for the Sample Input</h3>
<div>
<pre>180.27756377319946
113.13708498984761
98.99494936611666
90.50966799187809
90.50966799187809
</pre></div>
</a><div align="right"><a name="section_G">(End of Problem G) </a><a href="#section_A">A</a><a href="#section_B">B</a><a href="#section_C">C</a><a href="#section_D">D</a><a href="#section_E">E</a><a href="#section_F">F</a><a href="#section_G">G</a>
</div>
</div>
</div>
</div>  </div>

  </div>      </div> <!--/#main-content -->
</div><!--main-->
</div>
</div>
  <div id="footerwrapper" class="wrapper">

    <div id="footer" class="container-16 clear-block">

          <div id="footer-region" class="region grid-16 clear-block">
        <div id="block-block-1" class="block block-block">

  <div class="content">
    <div id="contact">
        ACM-ICPC東京大会実行委員会
</div>
  </div>
</div>
      </div>
    
    
    </div> <!--/#footer -->
  </div> <!--/#footerwrapper -->

</body></html>
